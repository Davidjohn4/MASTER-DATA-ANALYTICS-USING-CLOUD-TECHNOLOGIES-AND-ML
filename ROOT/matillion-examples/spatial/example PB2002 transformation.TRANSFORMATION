{"job":{"components":{"351":{"id":351,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":1223,"y":314,"width":32,"height":32,"inputConnectorIDs":[353],"outputConnectorIDs":[355],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename 0"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"q_id"},"2":{"slot":2,"type":"STRING","value":"event_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"yyyymmdd"},"2":{"slot":2,"type":"STRING","value":"yyyymmdd"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"depth_km_string"},"2":{"slot":2,"type":"STRING","value":"depth_km"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"magnitude"},"2":{"slot":2,"type":"STRING","value":"magnitude"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"longitude"},"2":{"slot":2,"type":"STRING","value":"longitude"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"latitude"},"2":{"slot":2,"type":"STRING","value":"latitude"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"boundary_type"},"2":{"slot":2,"type":"STRING","value":"location_type"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"boundary_name_coalesce"},"2":{"slot":2,"type":"STRING","value":"boundary_name"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"km_to_boundary"},"2":{"slot":2,"type":"STRING","value":"km_to_boundary"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"counter"},"2":{"slot":2,"type":"STRING","value":"counter"}}}},"visible":true},"3":{"slot":3,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"352":{"id":352,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1351,"y":314,"width":32,"height":32,"inputConnectorIDs":[355],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rewrite agg_qb"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"agg_qb"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"9":{"slot":9,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"393":{"id":393,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":375,"y":234,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[361],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_quakes"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_quakes"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"UTC"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"depth"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"magnitude"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"geo"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"394":{"id":394,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":583,"y":394,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[356],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_pb2002"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_pb2002"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"name"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"type"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"geo"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"395":{"id":395,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":487,"y":234,"width":32,"height":32,"inputConnectorIDs":[361],"outputConnectorIDs":[359],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Only Mag >= 2"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"magnitude"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"2"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"396":{"id":396,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":583,"y":234,"width":32,"height":32,"inputConnectorIDs":[359],"outputConnectorIDs":[357],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Quake renamer"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ID"},"2":{"slot":2,"type":"STRING","value":"ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"UTC"},"2":{"slot":2,"type":"STRING","value":"UTC"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"depth"},"2":{"slot":2,"type":"STRING","value":"depth"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"magnitude"},"2":{"slot":2,"type":"STRING","value":"magnitude"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"geo"},"2":{"slot":2,"type":"STRING","value":"geo"}}}},"visible":true},"3":{"slot":3,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"397":{"id":397,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":711,"y":314,"width":32,"height":32,"inputConnectorIDs":[356,357],"outputConnectorIDs":[358],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Spatial Join"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Quake renamer"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"q"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_pb2002"},"2":{"slot":2,"type":"STRING","value":"pb"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ST_DISTANCE(\"q\".\"geo\", \"pb\".\"geo\") < 1000000"},"2":{"slot":2,"type":"STRING","value":"q_Left_pb"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"q.ID"},"2":{"slot":2,"type":"STRING","value":"q_id"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"q.UTC"},"2":{"slot":2,"type":"STRING","value":"UTC"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"q.depth"},"2":{"slot":2,"type":"STRING","value":"depth"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"q.magnitude"},"2":{"slot":2,"type":"STRING","value":"magnitude"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"q.geo"},"2":{"slot":2,"type":"STRING","value":"q_geo"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"pb.id"},"2":{"slot":2,"type":"STRING","value":"pb_id"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"pb.name"},"2":{"slot":2,"type":"STRING","value":"name"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"pb.type"},"2":{"slot":2,"type":"STRING","value":"type"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"pb.geo"},"2":{"slot":2,"type":"STRING","value":"pb_geo"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"398":{"id":398,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":839,"y":314,"width":32,"height":32,"inputConnectorIDs":[358],"outputConnectorIDs":[360],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Spatial Derivations"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ROUND(ST_DISTANCE(\"q_geo\", \"pb_geo\") / 1000)"},"2":{"slot":2,"type":"STRING","value":"km_to_boundary"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(\"UTC\")"},"2":{"slot":2,"type":"STRING","value":"ts_utc"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ST_X(\"q_geo\")"},"2":{"slot":2,"type":"STRING","value":"longitude"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ST_Y(\"q_geo\")"},"2":{"slot":2,"type":"STRING","value":"latitude"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"pb_id\" IS NULL THEN 'Intraplate'\nELSE INITCAP(COALESCE(NULLIF(\"type\", ''), 'boundary'))\nEND"},"2":{"slot":2,"type":"STRING","value":"boundary_type"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(\"pb_id\", 'Intraplate')"},"2":{"slot":2,"type":"STRING","value":"boundary_id_coalesce"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(\"name\", 'Intraplate')"},"2":{"slot":2,"type":"STRING","value":"boundary_name_coalesce"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"1"},"2":{"slot":2,"type":"STRING","value":"counter"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(TO_DATE(SUBSTR(\"q_id\",1,8), 'YYYYMMDD'), 'YYYY-MM-DD')"},"2":{"slot":2,"type":"STRING","value":"yyyymmdd"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"TRIM(TO_CHAR(\n  CASE\n    WHEN \"depth\" <= 0 THEN 0\n    ELSE ROUND(\"depth\", -1)\n  END,\n  '99999'))"},"2":{"slot":2,"type":"STRING","value":"depth_km_string"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"399":{"id":399,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":967,"y":314,"width":32,"height":32,"inputConnectorIDs":[360],"outputConnectorIDs":[354],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank prox"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"q_id"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"km_to_boundary"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Number"},"2":{"slot":2,"type":"STRING","value":"rn"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"400":{"id":400,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":1095,"y":314,"width":32,"height":32,"inputConnectorIDs":[354],"outputConnectorIDs":[353],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Only Closest"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rn"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"353":{"id":353,"sourceID":400,"targetID":351},"354":{"id":354,"sourceID":399,"targetID":400},"355":{"id":355,"sourceID":351,"targetID":352},"356":{"id":356,"sourceID":394,"targetID":397},"357":{"id":357,"sourceID":396,"targetID":397},"358":{"id":358,"sourceID":397,"targetID":398},"359":{"id":359,"sourceID":395,"targetID":396},"360":{"id":360,"sourceID":398,"targetID":399},"361":{"id":361,"sourceID":393,"targetID":395}},"notes":{"390":{"id":390,"x":592,"y":113,"width":403,"height":40,"text":"This is an example of a **spatial join** in a Matillion ETL data Transformation Job","colour":"00ce4f"},"391":{"id":391,"x":384,"y":356,"width":237,"height":92,"text":"Line segments from Shapefile","colour":"00ce4f"},"392":{"id":392,"x":312,"y":167,"width":114,"height":141,"text":"Point events","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"example PB2002 transformation","description":null,"type":"TRANSFORMATION","tag":"89505fcf-ce8c-4524-a094-34b7b99516bb"}}