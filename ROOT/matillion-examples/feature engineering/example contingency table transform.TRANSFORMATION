{"job":{"components":{"407":{"id":407,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":449,"y":378,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[420],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"All flights"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_training_flights"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"crs_departure_time"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"arrival_time"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"crs_arrival_time"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"flight_number"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"destination"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"actual_elapsed_time"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"airtime"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"408":{"id":408,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":609,"y":218,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[421],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CalendarDate"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Observance"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"409":{"id":409,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":609,"y":378,"width":32,"height":32,"inputConnectorIDs":[420,421],"outputConnectorIDs":[418],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fed Holidays"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"All flights"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"},"2":{"slot":2,"type":"STRING","value":"ob"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"f\".\"flight_date\" = \"ob\".\"CalendarDate\""},"2":{"slot":2,"type":"STRING","value":"f_Left_ob"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f.flight_date"},"2":{"slot":2,"type":"STRING","value":"flight_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"f.crs_departure_time"},"2":{"slot":2,"type":"STRING","value":"crs_departure_time"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"f.arrival_time"},"2":{"slot":2,"type":"STRING","value":"arrival_time"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"f.crs_arrival_time"},"2":{"slot":2,"type":"STRING","value":"crs_arrival_time"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"f.flight_number"},"2":{"slot":2,"type":"STRING","value":"flight_number"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"f.airtime"},"2":{"slot":2,"type":"STRING","value":"airtime"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"f.origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"f.destination"},"2":{"slot":2,"type":"STRING","value":"destination"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"f.actual_elapsed_time"},"2":{"slot":2,"type":"STRING","value":"actual_elapsed_time"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ob.Observance"},"2":{"slot":2,"type":"STRING","value":"Observance"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"410":{"id":410,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":737,"y":298,"width":32,"height":32,"inputConnectorIDs":[418],"outputConnectorIDs":[422],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Business Rules"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"arrival_time"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Null"},"4":{"slot":4,"type":"STRING","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"crs_arrival_time"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Null"},"4":{"slot":4,"type":"STRING","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"airtime"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"411":{"id":411,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":849,"y":298,"width":32,"height":32,"inputConnectorIDs":[422],"outputConnectorIDs":[417,419],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Binning"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"60 * CAST((\"crs_arrival_time\" - MOD(\"crs_arrival_time\", 100)) / 100 AS INTEGER) + MOD(\"crs_arrival_time\", 100)"},"2":{"slot":2,"type":"STRING","value":"crs_arrival_mpm"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"60 * CAST((\"arrival_time\" - MOD(\"arrival_time\", 100)) / 100 AS INTEGER) + MOD(\"arrival_time\", 100)"},"2":{"slot":2,"type":"STRING","value":"arrival_mpm"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CASE\n     /* Flights due to arrive late evening and actually arriving next day */\n     WHEN \"arrival_mpm\" - \"crs_arrival_mpm\" < -500\n     THEN \"arrival_mpm\" - \"crs_arrival_mpm\" + 1440\n     /* Flights due to arrive early morning but actually arriving the evening of the day before */\n     WHEN \"arrival_mpm\" - \"crs_arrival_mpm\" > 1200\n     THEN \"arrival_mpm\" - \"crs_arrival_mpm\" - 1440\n     /* For most flights the day is the same */\n     ELSE \"arrival_mpm\" - \"crs_arrival_mpm\"\nEND"},"2":{"slot":2,"type":"STRING","value":"DelayMinutes"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"DelayMinutes\" >= 45 THEN 'Large Delay'\n     WHEN \"DelayMinutes\" >= 15 THEN 'Medium Delay'\n     ELSE 'On Time'\nEND"},"2":{"slot":2,"type":"STRING","value":"LatenessCategory"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"Observance\" IS NULL THEN 'No Holiday'\n     ELSE 'Holiday'\nEND"},"2":{"slot":2,"type":"STRING","value":"HolidayCategory"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"412":{"id":412,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":1009,"y":218,"width":32,"height":32,"inputConnectorIDs":[419],"outputConnectorIDs":[416],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Top level aggregation"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LatenessCategory"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"HolidayCategory"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_date"},"2":{"slot":2,"type":"STRING","value":"Count"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"413":{"id":413,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":1009,"y":378,"width":32,"height":32,"inputConnectorIDs":[417],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flight delay analysis - granular data (view)"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"v_flight_delay_analysis"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Secure View","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"View Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"414":{"id":414,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":609793074,"x":1136,"y":224,"width":32,"height":32,"inputConnectorIDs":[416],"outputConnectorIDs":[423],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Proportions"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"HolidayCategory"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{},"visible":true},"5":{"slot":5,"name":"Lower Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Upper Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"7":{"slot":7,"name":"Lower Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"8":{"slot":8,"name":"Upper Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"9":{"slot":9,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sum"},"2":{"slot":2,"type":"STRING","value":"count_flight_date"},"3":{"slot":3,"type":"STRING","value":"CountByHolidayCategory"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"415":{"id":415,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1280,"y":224,"width":32,"height":32,"inputConnectorIDs":[423],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flight delay analysis - summary data"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"summary_flight_delay"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"9":{"slot":9,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"416":{"id":416,"sourceID":412,"targetID":414},"417":{"id":417,"sourceID":411,"targetID":413},"418":{"id":418,"sourceID":409,"targetID":410},"419":{"id":419,"sourceID":411,"targetID":412},"420":{"id":420,"sourceID":407,"targetID":409},"421":{"id":421,"sourceID":408,"targetID":409},"422":{"id":422,"sourceID":410,"targetID":411},"423":{"id":423,"sourceID":414,"targetID":415}},"notes":{"405":{"id":405,"x":519,"y":169,"width":395,"height":255,"text":"These are the business rules and definitions that need to be shared","colour":"00ce4f"},"406":{"id":406,"x":286,"y":194,"width":143,"height":78,"text":"Run the \"example contingency table setup\" job first to create the database objects","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"example contingency table transform","description":null,"type":"TRANSFORMATION","tag":"2b8cf453-0c84-4b2c-bf32-1f6a795b710f"}}